<!DOCTYPE html>
<html>
<head>
	<title>Simple Simon</title>
	<style>
		h1 {
			text-align: center;
			font-family: Arial, Helvetica, sans-serif;
		}

		.square {
			width: 230px;
			height: 230px;
			border-collapse: collapse;
			float: left;
			margin: 10px;
		}

		#gameBoard {
			width: 500px;
			height: 500px;
			margin: 0 auto;
			border: #cccccc 1px solid;
			background-color: #bbbbbb;
			padding: 5px;
		}

		#red {		
			background-color: red;
		}

		#blue {
			background-color: blue;
		}
		
		#green {
			background-color: green;
		}

		#yellow {
			background-color: yellow;
		}

		.active {
			opacity: 0.5;
		}

		#begin {
			display: block;
			height: 35px;
			width: 100px; 
			margin: 10px auto;
			padding: 5px;
			background-color: #bbbbbb;
		}
	</style>
</head>
<body>
	
	
	<div id="container">
		<h1>Simple Simon</h1>
		<button id="begin">START</button>
		<div id="gameBoard">
			<div class="square" id="red"></div>
			<div class="square" id="blue"></div>
			<div class="square" id="green"></div>
			<div class="square" id="yellow"></div>
		</div>
	</div>
	

	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

	<script>
	"use strict";
    $(document).ready(function () {

    	var simonSequence = [];
//    	console.log(simonSequence);
    	var userIndex = 0;  
//    	console.log(userIndex);

    	// This function controls animation style only 
    	function animateSquare(id) {
    		$("#" + id).addClass("active");
    		setTimeout(function() {
    			$("#" + id).removeClass("active");
    		}, 500);
    	};

    	// This function controls the square(s) animated by Simon
    	function animateSimonSquare() {
    		var squares = $(".square");
    		var selectRandomSquare = Math.floor(Math.random()*4);
//    		console.log(selectRandomSquare);
    		var randomSquare = squares[selectRandomSquare];
//    		console.log(randomSquare);
    		var id = randomSquare.getAttribute("id");
//   		console.log(id);
    		simonSequence.push(id);
    		console.log(simonSequence);
    	};

    	// This listener attached to the START button
    	$("#begin").click(function() {
    		simonSequence = [];
    		animateSimonSquare();
    		simonSays();
    	})

    	// This listener triggered by user input
    	$(".square").click(function(e) {
    		var squareClicked = $(this).attr("id");
    		animateSquare(squareClicked);
			if (squareClicked == simonSequence[userIndex]){
				userIndex += 1;
				if (userIndex == simonSequence.length) {
					copy();
					userIndex = 0;
				}
			} else {
				alert("game over");
				location.reload(true);
			}
    	});


    	// This function runs the game 
    	function simonSays() {
    		var i = 0;
    		var intervalId = setInterval(function() {
    			if (i >= simonSequence.length) {
    				clearInterval(intervalId);
    			}
    			animateSquare(simonSequence[i]);
    			i += 1;
    		}, 1000);
    	}

    	function copy() {
    		animateSimonSquare();
    		$("#round").text("Round: " + simonSequence.length);
    		simonSays();
    	}


    });	



 // NOTES: Instead of comparing arrays, you should have a user index. and at the start of each round, the user index needs to be at 0. then user index needs to add one -- so userIndex++, and it moves to next item in simon sequence. one userIndex = simonSequence.length, then it's Simon's turn again to add another item.    	


    
	</script>

</body>
</html>